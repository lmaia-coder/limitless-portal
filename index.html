<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Limitless Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #000;
        }
        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .font-title {
            font-family: 'Plus Jakarta Sans', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-content.open {
            max-height: 1000px; /* Adjust as needed */
            transition: max-height: 0.5s ease-in;
        }
        .nav-item.active {
            color: white;
            background-color: #0D0095;
        }
        .nav-item.active svg {
            stroke: white;
        }
        /* Mobile nav active state */
        .mobile-nav .nav-item.active {
            color: #33B6FF;
            background-color: transparent;
        }
        .mobile-nav .nav-item.active svg {
            stroke: #33B6FF;
        }
        /* Glassmorphism Effect */
        .glass-effect {
            background: rgba(31, 41, 55, 0.4); /* bg-gray-800 with transparency */
            -webkit-backdrop-filter: blur(12px);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        /* Glow Effects */
        .btn-glow {
            transition: all 0.3s ease-in-out;
        }
        .btn-glow:hover {
            box-shadow: 0 0 15px 5px rgba(51, 182, 255, 0.4);
            transform: translateY(-2px);
        }
        @keyframes pulse-glow {
            0%, 100% {
                text-shadow: 0 0 10px rgba(51, 182, 255, 0.5), 0 0 20px rgba(51, 182, 255, 0.3);
            }
            50% {
                text-shadow: 0 0 20px rgba(51, 182, 255, 0.8), 0 0 40px rgba(51, 182, 255, 0.5);
            }
        }
        /* This is no longer used, but kept for potential future use */
        .countdown-glow {
            /* animation: pulse-glow 4s infinite ease-in-out; */
        }
    </style>
</head>
<body class="bg-black text-gray-200">
    <canvas id="particle-canvas"></canvas>

    <!-- Main Application Container -->
    <div id="app" class="max-w-md md:max-w-6xl mx-auto bg-gray-900/50 glass-effect shadow-lg rounded-lg overflow-hidden mt-0 md:mt-8" style="display: none;">
        <header class="bg-[#0D0095] text-white p-4 flex justify-between items-center">
            <div>
                <h1 class="text-xl font-bold font-title">Limitless Portal</h1>
            </div>
            <div class="relative">
                <button id="change-party-button" class="font-semibold flex items-center gap-1 hover:bg-black/20 p-2 rounded-md transition-colors">
                    <span id="header-party-name"></span>
                    <i data-lucide="chevron-down" class="w-4 h-4"></i>
                </button>
                <div id="party-dropdown" class="absolute right-0 mt-2 w-48 bg-gray-700/80 glass-effect rounded-md shadow-lg py-1 z-20 hidden">
                    <!-- Dropdown items will be injected here -->
                </div>
            </div>
        </header>
        
        <div class="md:grid md:grid-cols-[240px_1fr]">
            <!-- Desktop Sidebar Navigation -->
            <nav id="desktop-nav" class="hidden md:flex flex-col border-r border-gray-700 bg-transparent p-4 space-y-2">
                <button data-tab="home" class="nav-item w-full flex items-center gap-3 p-3 rounded-lg text-gray-400 hover:bg-gray-700 focus:outline-none">
                    <i data-lucide="home" class="w-5 h-5"></i>
                    <span class="font-medium">Home</span>
                </button>
                <button data-tab="attendees" class="nav-item w-full flex items-center gap-3 p-3 rounded-lg text-gray-400 hover:bg-gray-700 focus:outline-none">
                    <i data-lucide="users" class="w-5 h-5"></i>
                    <span class="font-medium">Attendees</span>
                </button>
                <button data-tab="info" class="nav-item w-full flex items-center gap-3 p-3 rounded-lg text-gray-400 hover:bg-gray-700 focus:outline-none">
                    <i data-lucide="info" class="w-5 h-5"></i>
                    <span class="font-medium">Info</span>
                </button>
                <button data-tab="chat" class="nav-item w-full flex items-center gap-3 p-3 rounded-lg text-gray-400 hover:bg-gray-700 focus:outline-none">
                    <i data-lucide="message-circle" class="w-5 h-5"></i>
                    <span class="font-medium">Chat</span>
                </button>
            </nav>

            <main id="content" class="p-6 pb-24 md:pb-6 fade-in min-h-[calc(100vh-150px)] md:min-h-0">
                <!-- Dynamic content will be injected here -->
            </main>
        </div>

        <!-- Mobile Bottom Navigation -->
        <nav id="mobile-nav" class="mobile-nav fixed bottom-0 left-0 right-0 max-w-md md:hidden mx-auto bg-gray-900/80 glass-effect border-t border-gray-700 flex justify-around">
            <button data-tab="home" class="nav-item flex-1 p-3 text-center text-gray-400 hover:bg-gray-800 focus:outline-none">
                <i data-lucide="home" class="mx-auto w-6 h-6 mb-1"></i>
                <span class="text-xs">Home</span>
            </button>
            <button data-tab="attendees" class="nav-item flex-1 p-3 text-center text-gray-400 hover:bg-gray-800 focus:outline-none">
                <i data-lucide="users" class="mx-auto w-6 h-6 mb-1"></i>
                <span class="text-xs">Attendees</span>
            </button>
            <button data-tab="info" class="nav-item flex-1 p-3 text-center text-gray-400 hover:bg-gray-800 focus:outline-none">
                <i data-lucide="info" class="mx-auto w-6 h-6 mb-1"></i>
                <span class="text-xs">Info</span>
            </button>
            <button data-tab="chat" class="nav-item flex-1 p-3 text-center text-gray-400 hover:bg-gray-800 focus:outline-none">
                <i data-lucide="message-circle" class="mx-auto w-6 h-6 mb-1"></i>
                <span class="text-xs">Chat</span>
            </button>
        </nav>
    </div>

    <!-- Party Selection Modal -->
    <div id="party-selection-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-gray-800/50 glass-effect rounded-lg shadow-xl w-full max-w-md md:max-w-4xl overflow-hidden">
             <div class="md:flex">
                <!-- Left Section: App Hub -->
                <div class="p-6 md:w-1/2">
                    <h2 class="text-3xl font-bold text-center text-white font-title">Limitless Portal</h2>
                    <p class="text-gray-400 text-center mt-1">Select a party location to find out more about it!</p>
                    <p class="text-xs text-gray-500 mt-4 mb-4 text-center">Note: This only sets your app view and does not confirm your attendance. You must fill out the registration form to RSVP.</p>
                    <div id="party-selection-buttons" class="grid grid-cols-1 gap-3">
                        <!-- Buttons will be dynamically injected here -->
                    </div>
                </div>

                <!-- Right Section: Registration -->
                <div class="p-6 md:w-1/2 bg-gray-900/20 md:border-l md:border-gray-700 flex flex-col justify-center text-center">
                    <h2 class="text-2xl font-bold text-white font-title">Confirm your attendance<br>at the party!</h2>
                    <div class="mt-6 space-y-3">
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLScl_6vLegdEGcinpmpuwykU4s3aE7Y_P64iuTwbhyWYB1I4RA/viewform?usp=dialog" target="_blank" class="block w-full bg-[#33B6FF] text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-[#2aa5ef] transition-colors btn-glow">
                            Internal Employee Registration
                        </a>
                        <a href="https://forms.gle/qwJJ4tFsdMU6tgG68" target="_blank" class="block w-full bg-[#33B6FF] text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-[#2aa5ef] transition-colors btn-glow">
                            External Employee Registration
                        </a>
                    </div>
                    <p class="text-xs text-gray-500 mt-4">The registration period ends in October 17th.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
             // --- LIGHT FLARE SCRIPT ---
            const canvas = document.getElementById('particle-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            let flaresArray;

            class Flare {
                constructor() {
                    this.reset();
                    // Use the color #1043fa with random opacity
                    this.color = `rgba(16, 67, 250, ${Math.random() * 0.5 + 0.2})`; 
                }
                
                reset() {
                    this.size = Math.random() * 2 + 1;
                    // Start from a random edge
                    if (Math.random() > 0.5) {
                        this.x = Math.random() > 0.5 ? 0 - this.size : canvas.width + this.size;
                        this.y = Math.random() * canvas.height;
                    } else {
                        this.x = Math.random() * canvas.width;
                        this.y = Math.random() > 0.5 ? 0 - this.size : canvas.height + this.size;
                    }

                    // Angle towards a random point near the center to make it look interesting
                    const targetX = canvas.width / 2 + (Math.random() - 0.5) * (canvas.width / 2);
                    const targetY = canvas.height / 2 + (Math.random() - 0.5) * (canvas.height / 2);
                    const angle = Math.atan2(targetY - this.y, targetX - this.x);
                    const speed = Math.random() * 2 + 1;
                    this.directionX = Math.cos(angle) * speed;
                    this.directionY = Math.sin(angle) * speed;
                }

                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
                    ctx.fillStyle = this.color;
                    ctx.fill();
                }

                update() {
                    // Reset if it goes too far off screen
                    if (this.x < -this.size * 2 || this.x > canvas.width + this.size * 2 || this.y < -this.size * 2 || this.y > canvas.height + this.size * 2) {
                       this.reset();
                    }
                    this.x += this.directionX;
                    this.y += this.directionY;
                    this.draw();
                }
            }

            function initFlares() {
                flaresArray = [];
                let numberOfFlares = (canvas.height * canvas.width) / 10000;
                for (let i = 0; i < numberOfFlares; i++) {
                    flaresArray.push(new Flare());
                }
            }

            function animateFlares() {
                requestAnimationFrame(animateFlares);
                // Create the trailing effect by not clearing the canvas completely
                ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                for (let i = 0; i < flaresArray.length; i++) {
                    flaresArray[i].update();
                }
            }

            window.addEventListener('resize', () => {
                canvas.width = innerWidth;
                canvas.height = innerHeight;
                initFlares();
            });
            
            initFlares();
            animateFlares();


            // --- DATA STORE ---
            const partyData = {
                madrid: {
                    id: 'madrid',
                    name: "Madrid",
                    headerName: "Madrid EOY Party",
                    date: "December 5, 2025",
                    location: "Madrid, Spain",
                    startTime: "TBC",
                    venueName: "TBC",
                    venueAddress: "TBC",
                    invitedCountries: "Spain, United Kingdom, Malta, Netherlands, Germany, Italy, Ireland, Portugal, Belgium, France, Austria, Czech Republic, Cyprus, Georgia, Morocco."
                },
                montevideo: {
                    id: 'montevideo',
                    name: "Montevideo",
                    headerName: "Montevideo EOY Party",
                    date: "December 5, 2025",
                    location: "Montevideo, Uruguay",
                    startTime: "TBC",
                    venueName: "TBC",
                    venueAddress: "TBC",
                    invitedCountries: "Uruguay, Argentina, Chile, Peru, Bolivia."
                },
                saopaulo: {
                    id: 'saopaulo',
                    name: "São Paulo",
                    headerName: "São Paulo EOY Party",
                    date: "December 5, 2025",
                    location: "São Paulo, Brazil",
                    startTime: "TBC",
                    venueName: "TBC",
                    venueAddress: "TBC",
                    invitedCountries: "Brazil, Colombia, Mexico, Costa Rica, Panama, Paraguay, Dominican Republic, Guatemala, Honduras, Ecuador, United States."
                },
                nairobi: {
                    id: 'nairobi',
                    name: "Nairobi",
                    headerName: "Nairobi EOY Party",
                    date: "December 11, 2025",
                    location: "Nairobi, Kenya",
                    startTime: "TBC",
                    venueName: "TBC",
                    venueAddress: "TBC",
                    invitedCountries: "South Africa, Nigeria, Kenya, Egypt, Uganda, United Arab Emirates, Ghana, Bahrain, Turkey, Senegal and Saudi Arabia."
                },
                kualalumpur: {
                    id: 'kualalumpur',
                    name: "Kuala Lumpur",
                    headerName: "Kuala Lumpur EOY Party",
                    date: "December 12, 2025",
                    location: "Kuala Lumpur, Malaysia",
                    startTime: "TBC",
                    venueName: "TBC",
                    venueAddress: "TBC",
                    invitedCountries: "China, India, Malaysia, Singapore, Indonesia, Philippines, Viet Nam, Bangladesh, Japan, Australia."
                }
            };

            // --- STATE MANAGEMENT ---
            let state = {
                selectedPartyId: null,
                activeTab: 'home',
                countdownIntervalId: null,
            };

            // --- UI ELEMENTS ---
            const appContainer = document.getElementById('app');
            const partySelectionModal = document.getElementById('party-selection-modal');
            const contentContainer = document.getElementById('content');
            const navButtons = document.querySelectorAll('.nav-item');
            const changePartyButton = document.getElementById('change-party-button');
            const partyDropdown = document.getElementById('party-dropdown');
            const headerPartyName = document.getElementById('header-party-name');

            // --- RENDER FUNCTIONS ---
            
            const render = () => {
                if (!state.selectedPartyId) {
                    appContainer.style.display = 'none';
                    partySelectionModal.style.display = 'flex';
                    renderPartySelectionModal();
                } else {
                    partySelectionModal.style.display = 'none';
                    appContainer.style.display = 'block';
                    renderApp();
                }
                lucide.createIcons();
            };
            
            const renderApp = () => {
                updateHeader();
                updateNav();
                renderContent();
            };

            const updateHeader = () => {
                if (state.selectedPartyId) {
                    headerPartyName.textContent = partyData[state.selectedPartyId].name;
                } else {
                    headerPartyName.textContent = 'Select Party';
                }
            };
            
            const updateNav = () => {
                 navButtons.forEach(btn => {
                    const tab = btn.dataset.tab;
                     if(tab === state.activeTab) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            };

            const renderContent = () => {
                if (state.countdownIntervalId) {
                    clearInterval(state.countdownIntervalId);
                    state.countdownIntervalId = null;
                }
                contentContainer.innerHTML = ''; 
                contentContainer.classList.remove('fade-in');
                void contentContainer.offsetWidth;
                contentContainer.classList.add('fade-in');

                switch (state.activeTab) {
                    case 'home':
                        renderHomeTab();
                        break;
                    case 'attendees':
                        renderAttendeesTab();
                        break;
                    case 'info':
                        renderInfoTab();
                        break;
                    case 'chat':
                        renderChatTab();
                        break;
                }
                lucide.createIcons();
            };

            const renderPartySelectionModal = () => {
                const partySelectionButtons = document.getElementById('party-selection-buttons');
                partySelectionButtons.innerHTML = Object.values(partyData).map(party =>
                    `<button data-party-id="${party.id}" class="party-select-btn btn-glow w-full bg-gray-200 text-[#1043fa] font-semibold py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors">
                        ${party.name}
                    </button>`
                ).join('');

                document.querySelectorAll('.party-select-btn').forEach(btn => {
                    btn.addEventListener('click', handlePartySelection);
                });
            };

            const renderPartyDropdown = () => {
                partyDropdown.innerHTML = Object.values(partyData).map(party =>
                    `<a href="#" data-party-id="${party.id}" class="party-select-link block px-4 py-2 text-sm text-gray-200 hover:bg-gray-600">${party.name}</a>`
                ).join('');

                document.querySelectorAll('.party-select-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        handlePartySelection(e);
                        partyDropdown.classList.add('hidden');
                    });
                });
            };

            // --- TAB CONTENT RENDERERS ---

            const renderHomeTab = () => {
                const party = partyData[state.selectedPartyId];
                contentContainer.innerHTML = `
                    <div class="space-y-6">
                        <div class="text-center">
                            <h2 class="text-3xl font-bold text-white font-title">${party.headerName}</h2>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div id="countdown-container-wrapper" class="glass-effect p-4 rounded-lg shadow h-full flex flex-col justify-center">
                                <p class="text-center text-gray-400 mb-2">Countdown to the party!</p>
                                <div id="countdown-container" class="text-center">
                                </div>
                            </div>

                            <div class="glass-effect p-4 rounded-lg shadow h-full flex flex-col justify-center">
                                <div class="space-y-4 text-center">
                                    <div>
                                        <p class="text-sm text-gray-400">Date</p>
                                        <p class="font-semibold text-lg">${party.date}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-400">Location</p>
                                        <p class="font-semibold text-lg">${party.location}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-sky-900/50 border-l-4 border-sky-500 text-sky-200 p-4 rounded-lg shadow-sm" role="alert">
                            <div class="flex">
                                <div class="py-1">
                                    <i data-lucide="alert-circle" class="w-6 h-6 text-sky-500 mr-4"></i>
                                </div>
                                <div>
                                    <p class="font-bold">The deadline to confirm your attendance is October 17th!</p>
                                    <p class="text-sm">To confirm your attendance, please fill out <a href="https://docs.google.com/forms/d/e/1FAIpQLScl_6vLegdEGcinpmpuwykU4s3aE7Y_P64iuTwbhyWYB1I4RA/viewform?usp=dialog" target="_blank" class="font-semibold underline hover:text-sky-100">this form if you are an internal employee</a> or <a href="https://forms.gle/qwJJ4tFsdMU6tgG68" target="_blank" class="font-semibold underline hover:text-sky-100">this form if you are an external employee</a>.</p>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-xl font-semibold mb-3 font-title">How to Get There</h3>
                            <div class="glass-effect p-4 rounded-lg shadow space-y-2">
                                <p><span class="font-semibold">Start Time:</span> ${party.startTime}</p>
                                <p><span class="font-semibold">Venue Name:</span> ${party.venueName}</p>
                                <p><span class="font-semibold">Address:</span> ${party.venueAddress}</p>
                                <button id="maps-button" class="mt-4 w-full bg-[#33B6FF] text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-[#2aa5ef] transition-colors flex items-center justify-center gap-2 btn-glow" ${party.venueAddress === 'TBC' ? 'disabled' : ''}>
                                    <i data-lucide="map-pin" class="w-5 h-5"></i>
                                    Open in Google Maps
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                document.getElementById('maps-button')?.addEventListener('click', () => {
                    if (party.venueAddress !== 'TBC') {
                        window.open(`https://maps.google.com/?q=${encodeURIComponent(party.venueAddress)}`, '_blank');
                    }
                });

                const countdownContainer = document.getElementById('countdown-container');
                const partyDate = new Date(party.date).getTime();

                const updateCountdown = () => {
                    const now = new Date().getTime();
                    const distance = partyDate - now;

                    if (distance < 0) {
                        document.getElementById('countdown-container-wrapper').innerHTML = `<div class="text-center text-lg font-bold text-[#33B6FF] py-4 font-title">The party has started!</div>`;
                        if(state.countdownIntervalId) clearInterval(state.countdownIntervalId);
                        return;
                    }

                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    countdownContainer.innerHTML = `
                        <div>
                            <div class="text-5xl font-bold text-[#33B6FF]">${days}</div>
                            <div class="text-sm text-gray-500 uppercase">Days to go</div>
                        </div>
                    `;
                };
                
                updateCountdown();
                state.countdownIntervalId = setInterval(updateCountdown, 1000);
            };

            const renderAttendeesTab = () => {
                const party = partyData[state.selectedPartyId];
                contentContainer.innerHTML = `
                    <div class="text-center space-y-6">
                         <h2 class="text-2xl font-bold font-title">Who's Going to the ${party.name} Party?</h2>

                         <div class="glass-effect p-4 rounded-lg shadow text-left">
                            <h3 class="font-semibold text-lg mb-2 font-title">Invited Countries:</h3>
                            <p class="text-gray-300">${party.invitedCountries}</p>
                         </div>

                         <div class="bg-sky-900/50 border-l-4 border-sky-500 text-sky-200 p-4 rounded-lg text-left" role="alert">
                            <p class="font-bold">Coming Soon!</p>
                            <p>A detailed list with confirmed employee names will be added closer to the event date.</p>
                        </div>
                    </div>
                `;
            };

            const renderInfoTab = () => {
                contentContainer.innerHTML = `
                    <h2 class="text-2xl font-bold mb-6 text-center font-title">Party Information</h2>
                    <div class="space-y-2">
                        ${createInfoAccordion('Confirming Attendance', `
                            <p>To confirm your attendance, fill out <a href="https://docs.google.com/forms/d/e/1FAIpQLScl_6vLegdEGcinpmpuwykU4s3aE7Y_P64iuTwbhyWYB1I4RA/viewform?usp=dialog" target="_blank" class="text-[#33B6FF] hover:underline">this form if you are an internal employee</a> or <a href="https://forms.gle/qwJJ4tFsdMU6tgG68" target="_blank" class="text-[#33B6FF] hover:underline">this form if you are an external employee</a> by October 17.</p>
                            <p>Once the registration is submitted, no changes will be allowed.</p>
                            <p>People will only be able to attend a party if they confirm their attendance on the registration form.</p>
                            <p class="mt-2"><strong>Exception:</strong></p>
                            <ul class="list-disc list-inside space-y-1 pl-2">
                                <li>People not present during the whole registration period (on vacation or license) will be contacted to have their registration concluded once they are back.</li>
                                <li>New joiners with a start date subsequent to the registration period will be contacted to confirm their attendance.</li>
                            </ul>
                        `)}
                        ${createInfoAccordion('Request to Change Parties', `
                            <p><strong>The change request must be made during the registration process in the provided <a href="https://docs.google.com/forms/d/e/1FAIpQLScl_6vLegdEGcinpmpuwykU4s3aE7Y_P64iuTwbhyWYB1I4RA/viewform?usp=dialog" target="_blank" class="text-[#33B6FF] hover:underline">registration form</a>. Once the registration is submitted, no further changes will be allowed.</strong></p>
                            <p>Employees will be able to request to attend a different party than the eligible one, but, in this case, no travel or stay expenses will be covered.</p>
                            <p class="mt-2"><strong>Exception:</strong> If you are located in a country other than your residence during the party period and communicate it in your registration process, you can choose to attend the party that residents of this location were invited to, with costs covered.</p>
                            <p><strong>Example:</strong> If you live in Spain and can't attend Madrid's party because you will be located in Colombia in December, you can go to the party Colombian residents were invited to (in this case, São Paulo) with costs covered.</p>
                        `)}
                        ${createInfoAccordion('Covered Costs', `
                           <p>By default, the covered costs for internal employees attending the parties to which they were invited will be:</p>
                           <ul class="list-disc list-inside space-y-1 my-2 pl-2">
                               <li>A round trip from the city mentioned in the registration form to the party's city.</li>
                               <li>One night's accommodation.</li>
                           </ul>
                           <p><strong>Observations:</strong></p>
                           <p>Any other expenses will not be covered, such as:</p>
                           <ul class="list-disc list-inside space-y-1 pl-2">
                               <li>Transportation inside the cities (Uber, taxis or public transportation).</li>
                               <li>Airport-to-hotel and hotel-to-venue expenses won't be covered.</li>
                               <li>Meals outside of the party.</li>
                               <li>Externals will not have any travel, visa or stay expenses covered.</li>
                               <li>The party attendance, travel and accommodation are restricted to invited dLocal team members only. External guests (family/partner/friend) are not allowed.</li>
                           </ul>
                        `)}
                        ${createInfoAccordion('Travel & Accommodation', `
                            <p>Once you submit your registration, our team will start arranging your travel and accommodation and reach out to you via email within 10 business days.</p>
                            <h4 class="font-semibold mt-3 mb-1 font-title">Flight/train booking</h4>
                            <p>The flight/train booking will be done by Jetmar (travel agency).</p>
                            <p>The agency will email employees with their flight details.</p>
                            <p>Employees must confirm the flight booking by answering the email within 3 business days.</p>
                            <p>If the flight/train informed by the agency doesn't work for an employee due to a valid personal or business reason, answer the email detailing the reason, and the agency will try to accommodate.</p>
                            <h4 class="font-semibold mt-3 mb-1 font-title">Buquebus booking</h4>
                            <p>The Buquebus booking will be done by the party organization team</p>
                            <p>Requests must be made through <a href="#" target="_blank" class="text-[#33B6FF] hover:underline">this form</a> by October 21.</p>
                            <h4 class="font-semibold mt-3 mb-1 font-title">Bus/car journeys</h4>
                            <p>The party organization team will provide a Mesh card with a pre-calculated amount for the journey.</p>
                            <h4 class="font-semibold mt-3 mb-1 font-title">Accommodation booking</h4>
                            <p>The organization team or Jetmar (travel agency) will book the accommodation, and its details will be emailed to the employee.</p>
                            <p>Each employee will have their own room; there will be no need to share.</p>
                        `)}
                        ${createInfoAccordion('Visas', `
                             <p>Check the visa/permission needs for your destination before you confirm attendance.</p>
                             <p>The visa/permission request process must be handled by the employees themselves.</p>
                             <p>We will cover the visa expenses and provide a reference letter if needed. Please <a href="https://docs.google.com/forms/d/e/1FAIpQLSdHjMZsYp2d14n_7sQAVe2LdF_hpSnMoQpX1ZcK_YSLlVqoRw/viewform?usp=dialog" target="_blank" class="text-[#33B6FF] hover:underline">request it here</a>. The request will be answered within 7 business days.</p>
                             <p class="mt-2"><strong>Pre-mapped visa/permission needs (please double-check online):</strong></p>
                             <ul class="list-disc list-inside space-y-1 pl-2">
                                 <li>São Paulo party: U.S. citizens require a Brazil e‑visa for short stays.</li>
                                 <li>Madrid party: Citizens of Morocco require a Schengen visa to visit Spain.</li>
                                 <li>Nairobi party: Travelers from Senegal, Turkey and Saudi Arabia require an eTA for Kenya.</li>
                                 <li>Kuala Lumpur party: Bangladesh passport holders typically require a visa/eVisa for Malaysia.</li>
                             </ul>
                             <p class="mt-4"><strong>If you opt to attend a different party then the one you were invited to, visa expenses will not be covered.</strong></p>
                        `)}
                        ${createInfoAccordion('Dress Code', `
                            <p>There is no formal dress code for the party. We encourage you to wear party-ready attire that you feel comfortable celebrating and dancing in.</p>
                        `)}
                        <h3 class="text-xl font-bold pt-4 font-title">Frequently Asked Questions</h3>
                        ${createInfoAccordion('1. Can I switch to a different party?', `
                            <p>You can choose the party you will attend in the registration form. Fill out the information requested in the form to see which party you can choose to attend, with costs covered. If your registration was already submitted, there's no possibility of changing it.</p>
                        `)}
                        ${createInfoAccordion('2. How do I book my travel and accommodation?', `
                            <p>Don\'t worry about the booking process. Our team will book it for you (in case you are eligible for expenses coverage) and contact you via email with the booking details.</p>
                        `)}
                        ${createInfoAccordion('3. Are external employees invited to the party?', `
                            <p>Yes, external employees are invited and must confirm their attendance through <a href="https://docs.google.com/forms/d/e/1FAIpQLSdwY1ZEt0vTQ6CFztzyt2i5zKWKeeCmn0zL2c6SO9kuxuTkdw/viewform?usp=dialog" target="_blank" class="text-[#33B6FF] hover:underline">this form</a>. Travel and accommodation expenses won\'t be covered in this case.</p>
                        `)}
                         ${createInfoAccordion('4. Can I bring a plus-one (family/partner/friend)?', `
                            <p>No. The official policy states that party attendance, as well as the covered travel and accommodation, are restricted to invited dLocal team members only. External guests, including family, partners, or friends, are not allowed.</p>
                        `)}
                        ${createInfoAccordion('5. What happens if I confirm and can\'t attend?', `
                            <p>Once your registration is submitted, all travel and accommodation arrangements will be booked on your behalf. If an unforeseen emergency prevents you from attending, request the cancellation through <a href="https://docs.google.com/forms/d/e/1FAIpQLSdHjMZsYp2d14n_7sQAVe2LdF_hpSnMoQpX1ZcK_YSLlVqoRw/viewform?usp=dialog" target="_blank" class="text-[#33B6FF] hover:underline">this form</a>.</p>
                        `)}
                        ${createInfoAccordion('6. What expenses will be covered by dLocal?', `
                            <p>For internal employees attending their eligible party, dLocal will cover: a round trip, one night of accommodation in a private room, and visa expenses, if required. Expenses not covered include city transport, airport transfers, and meals outside the party.</p>
                        `)}
                         ${createInfoAccordion('7. What if my country doesn’t have a local party?', `
                            <p>You are going to be invited to one of the five regional parties. Fill out the registration form to know which party you are invited to</p>
                        `)}
                        ${createInfoAccordion('8. Do I need to bring an ID to enter?', `
                            <p>No, you'll just need to confirm in the reception the document number informed during the registration process.</p>
                        `)}
                    </div>
                `;
                document.querySelectorAll('.accordion-header').forEach(header => {
                    header.addEventListener('click', () => {
                        const content = header.nextElementSibling;
                        const icon = header.querySelector('.accordion-icon');
                        content.classList.toggle('open');
                        icon.classList.toggle('rotate-180');
                    });
                });
            };
            
            const createInfoAccordion = (title, content) => {
                 return `
                    <div class="border border-gray-700 rounded-lg glass-effect">
                        <button class="accordion-header w-full text-left p-4 font-semibold flex justify-between items-center hover:bg-gray-700/50">
                            <span class="font-title">${title}</span>
                            <i data-lucide="chevron-down" class="accordion-icon w-5 h-5 transition-transform"></i>
                        </button>
                        <div class="accordion-content">
                            <div class="p-4 border-t border-gray-700 text-gray-400 space-y-2">
                                ${content}
                            </div>
                        </div>
                    </div>
                `;
            };

            const renderChatTab = () => {
                contentContainer.innerHTML = `
                    <div class="text-center flex flex-col items-center justify-center h-full space-y-4">
                        <i data-lucide="compass" class="w-16 h-16 text-[#33B6FF]"></i>
                        <h2 class="text-2xl font-bold font-title">Talk to Navigator</h2>
                        <p class="max-w-sm text-gray-400">
                            Have questions about the party? Click the button below to chat with Navigator, our AI-powered agent specialized in all party matters.
                        </p>
                        <a href="https://app.glean.com/chat/agents/30a4c365b4a04fe889edc06abd110be7" target="_blank" class="mt-4 w-full max-w-sm bg-[#33B6FF] text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-[#2aa5ef] transition-colors flex items-center justify-center gap-2 btn-glow">
                            <i data-lucide="external-link" class="w-5 h-5"></i>
                            Open Chat in a New Tab
                        </a>
                    </div>
                `;
            };

            // --- EVENT HANDLERS ---
            const handlePartySelection = (event) => {
                const partyId = event.currentTarget.dataset.partyId;
                state.selectedPartyId = partyId;
                localStorage.setItem('selectedPartyId', partyId);
                state.activeTab = 'home';
                render();
            };

            const handleNavClick = (event) => {
                const tab = event.currentTarget.dataset.tab;
                if (tab !== state.activeTab) {
                    state.activeTab = tab;
                    renderApp();
                }
            };

            // --- INITIALIZATION ---
            navButtons.forEach(btn => btn.addEventListener('click', handleNavClick));

            changePartyButton.addEventListener('click', () => {
                partyDropdown.classList.toggle('hidden');
            });
            window.addEventListener('click', (e) => {
                if (!changePartyButton.contains(e.target)) {
                    partyDropdown.classList.add('hidden');
                }
            });
            
            const savedPartyId = localStorage.getItem('selectedPartyId');
            if (savedPartyId && partyData[savedPartyId]) {
                state.selectedPartyId = savedPartyId;
            }

            renderPartyDropdown();
            render();
        });
    </script>
</body>
</html>





